<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<STYLE>
BODY, TABLE, TD, TH, P {
  font-family:Verdana,Helvetica,sans serif;
  font-size:11px;
  color:black;
}
h1 { color:black; }
h2 { color:black; }
h3 { color:black; }
TD.bg1 { color:white; background-color:#0000C0; font-size:120% }
TD.bg2 { color:white; background-color:#4040FF; font-size:110% }
TD.bg3 { color:white; background-color:#8080FF; }
TD.test_passed { color:blue; }
TD.test_failed { color:red; }
TD.console { font-family:Courier New; }
</STYLE>
 <BODY>
<TABLE>
  <TR><TD align="right"><IMG SRC="https://xxxxxxx/xxxx/public/jenkins/<%= build.result.toString() == 'SUCCESS' ? "Success.png" :build.result.toString() == 'FAILURE' ? 'Failure.png' : 'yellow.png'  %>"/></TD>
  <TD valign="center"><B style="font-size: 200%;">BUILD ${build.result}</B></TD></TR>
  <TR><TD>Build URL</TD><TD><A href="${rooturl}${build.url}">${rooturl}${build.url}</A></TD></TR>
  <TR><TD>Project:</TD><TD>${project.name}</TD></TR>
  <TR><TD>Date of build:</TD><TD>${it.timestampString}</TD></TR>
  <TR><TD>Build duration:</TD><TD>${build.durationString}</TD></TR>
  <TR><TD>Causes:</TD><TD>${build.causes.shortDescription}</TD></TR>
  <TR><TD>Changes</TD><TD><A href="${rooturl}${build.url}changes">${rooturl}${build.url}changes</A></TD></TR>
</TABLE>
<BR/>

<!--RELEASE LINKS-->
 <%
   def  path_work2 = build.getParent().getWorkspace().list("emailLinks.txt")
    path_work2.each() { file ->
       if (file.exists()) {	%>
			<TABLE width="100%">
				<TR><TD class="bg1" colspan="2"><B>RELEASE LINKS</B></TD></TR>
					<% def content = file.readToString() %>
					 <TR>
						<% def line = content.split('\n')
						    line.each() { url ->  %>
								<TR><TD>${url}</TD></TR> 
							<% } %>
					 </TR>
			</TABLE>				 
		<% }
	} %>

<BR/>
<!--CHANGE SET -->

<% def changeSet = build.changeSet
    if(changeSet != null) {
            def hadChanges = false
            def count = 0 %>
		  <TABLE width="100%">
		  <TR><TD class="bg1" colspan="2"><B>CHANGES IN THIS BUILD</B></TD></TR>

		     <%changeSet.each() { cs ->
                 	hadChanges = true
                 	def aUser = cs.author %>
			<TR>
			 	<TD>${cs.msgAnnotated} (${aUser.displayName}) </TD>
                   		<TD> (<a href="${rooturl}${build.url}changes#detail${count}">detail</a>)</TD>
                    		<%  count ++ %>
			</TR>

                    <%  }  %>

		    <% if(!hadChanges)  { %>	
			     <TR>No Changes</TR>
                    <%	} %>
    <%} %>
    </TABLE>

	
	
 </BODY>