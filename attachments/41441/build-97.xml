<?xml version='1.0' encoding='UTF-8'?>
<build>
  <actions>
    <hudson.model.CauseAction>
      <causeBag class="linked-hash-map">
        <entry>
          <hudson.model.Cause_-UserIdCause>
            <userId>rickliu</userId>
          </hudson.model.Cause_-UserIdCause>
          <int>1</int>
        </entry>
      </causeBag>
    </hudson.model.CauseAction>
    <hudson.model.CauseAction>
      <causeBag class="linked-hash-map">
        <entry>
          <com.sonyericsson.rebuild.RebuildCause plugin="rebuild@1.25">
            <upstreamProject>Test/Request_Branch_Permission_Change</upstreamProject>
            <upstreamUrl>view/All/job/Test/job/Request_Branch_Permission_Change/</upstreamUrl>
            <upstreamBuild>96</upstreamBuild>
            <upstreamCauses>
              <hudson.model.Cause_-UserIdCause>
                <userId>rickliu</userId>
              </hudson.model.Cause_-UserIdCause>
            </upstreamCauses>
          </com.sonyericsson.rebuild.RebuildCause>
          <int>1</int>
        </entry>
      </causeBag>
    </hudson.model.CauseAction>
    <jenkins.metrics.impl.TimeInQueueAction plugin="metrics@3.1.2.9">
      <queuingDurationMillis>4</queuingDurationMillis>
    </jenkins.metrics.impl.TimeInQueueAction>
    <org.jenkinsci.plugins.envinject.EnvInjectPluginAction plugin="envinject@2.1"/>
    <hudson.plugins.promoted__builds.PromotedBuildAction plugin="promoted-builds@2.28.1">
      <owner class="build" reference="../../.."/>
      <statuses/>
    </hudson.plugins.promoted__builds.PromotedBuildAction>
    <org.jvnet.hudson.plugins.groovypostbuild.GroovyPostbuildSummaryAction plugin="groovy-postbuild@2.3.1">
      <iconPath>terminal.gif</iconPath>
      <textBuilder>&lt;h1&gt;Build Node: jenkins-slave09)&lt;/h1&gt;</textBuilder>
    </org.jvnet.hudson.plugins.groovypostbuild.GroovyPostbuildSummaryAction>
    <hudson.model.ParametersAction>
      <safeParameters class="sorted-set"/>
      <parameters>
        <hudson.model.BooleanParameterValue>
          <name>AUTO_APPROVE</name>
          <value>true</value>
        </hudson.model.BooleanParameterValue>
        <hudson.model.StringParameterValue>
          <name>REQUESTER</name>
          <value>Rick Liu (rickliu)</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>REQUESTER_FULLNAME</name>
          <value>Rick Liu</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>REQUESTER_USERNAME</name>
          <value>rickliu</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>DEV_LEAD_FULLNAME</name>
          <value>Rick Liu</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>DEV_LEAD_USERNAME</name>
          <value>rickliu</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>PM_LEAD_FULLNAME</name>
          <value></value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>PM_LEAD_USERNAME</name>
          <value></value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>EMAIL_LIST</name>
          <value>rickliu@fortinet.com, kevinyu@fortinet.com, aadrian@fortinet.com</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>BUILD_PROMOTION_URL</name>
          <value>https://jenkins.corp.fortinet.com/job/Test/job/Request_Branch_Permission_Change/97/promotion</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>CURRENT_PERMISSION</name>
          <value>[[Username:Andrew Adrian (aadrian), Permission:R], [Username:David Shieh (dshieh), Permission:R], [Username:Kevin Yu (kevinyu), Permission:R], [Username:Rick Liu (rickliu), Permission:RW]]</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>CURRENT_PERMISSION_JSON</name>
          <value>[{&quot;Username&quot;:&quot;Andrew Adrian (aadrian)&quot;,&quot;Permission&quot;:&quot;R&quot;},{&quot;Username&quot;:&quot;David Shieh (dshieh)&quot;,&quot;Permission&quot;:&quot;R&quot;},{&quot;Username&quot;:&quot;Kevin Yu (kevinyu)&quot;,&quot;Permission&quot;:&quot;R&quot;},{&quot;Username&quot;:&quot;Rick Liu (rickliu)&quot;,&quot;Permission&quot;:&quot;RW&quot;}]</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>CURRENT_PERMISSION_EMAIL_TABLE_TEXT</name>
          <value>&lt;call&gt;
  &lt;table border=&apos;1&apos;&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Andrew Adrian (aadrian)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;David Shieh (dshieh)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Kevin Yu (kevinyu)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Rick Liu (rickliu)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;RW&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/call&gt;</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>PERMISSION_CHANGE</name>
          <value>[[Permission:RW, Username:Kevin Yu (kevinyu)], [Permission:R, Username:Rick Liu (rickliu)], [Permission:NONE, Username:Andrew Adrian (aadrian)]]</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>PERMISSION_CHANGE_EMAIL_TABLE_TEXT</name>
          <value>&lt;call&gt;
  &lt;table border=&apos;1&apos;&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Kevin Yu (kevinyu)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;RW&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Rick Liu (rickliu)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td width=&apos;300&apos;&gt;Andrew Adrian (aadrian)&lt;/td&gt;
      &lt;td width=&apos;60&apos;&gt;NONE&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/call&gt;</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>PROJECT</name>
          <description></description>
          <value>Test v6.00</value>
        </hudson.model.StringParameterValue>
        <hudson.model.StringParameterValue>
          <name>BRANCH</name>
          <description></description>
          <value>br_6-0_devops-test01</value>
        </hudson.model.StringParameterValue>
        <com.cwctravel.hudson.plugins.extended__choice__parameter.ExtendedChoiceParameterValue plugin="extended-choice-parameter@0.76">
          <name>PERMISSION_CHANGE_JSON</name>
          <value>[{&quot;Permission&quot;:&quot;RW&quot;,&quot;Username&quot;:&quot;Kevin Yu (kevinyu)&quot;},{&quot;Permission&quot;:&quot;R&quot;,&quot;Username&quot;:&quot;Rick Liu (rickliu)&quot;},{&quot;Permission&quot;:&quot;NONE&quot;,&quot;Username&quot;:&quot;Andrew Adrian (aadrian)&quot;}]</value>
        </com.cwctravel.hudson.plugins.extended__choice__parameter.ExtendedChoiceParameterValue>
      </parameters>
      <parameterDefinitionNames class="hudson.model.ParametersDefinitionProperty$1">
        <outer-class>
          <parameterDefinitions>
            <org.biouno.unochoice.ChoiceParameter plugin="uno-choice@1.4">
              <name>PROJECT</name>
              <description></description>
              <randomName>choice-parameter-1742676398102059</randomName>
              <visibleItemCount>122</visibleItemCount>
              <script class="org.biouno.unochoice.model.GroovyScript">
                <script>import groovy.sql.Sql
def String query = &quot;&quot;&quot;
SELECT DISTINCT p.name
FROM projects p, branches b, branches_projects bp
WHERE p.id = bp.project_id AND b.id = bp.branch_id AND b.kind = &apos;special&apos;
ORDER BY p.name
&quot;&quot;&quot;
result = [&apos;&apos;] + sql.rows(query).name
sql.close()
return result
</script>
                <fallbackScript>return [ &quot;error&quot; ]</fallbackScript>
              </script>
              <projectName>Request_Branch_Permission_Change</projectName>
              <choiceType>PT_SINGLE_SELECT</choiceType>
              <filterable>true</filterable>
            </org.biouno.unochoice.ChoiceParameter>
            <org.biouno.unochoice.CascadeChoiceParameter plugin="uno-choice@1.4">
              <name>BRANCH</name>
              <description></description>
              <randomName>choice-parameter-1742676398847207</randomName>
              <visibleItemCount>1</visibleItemCount>
              <script class="org.biouno.unochoice.model.GroovyScript">
                <script>import groovy.sql.Sql
def String query = &quot;&quot;&quot;
SELECT b.name
FROM projects p, branches b, branches_projects bp
WHERE p.id = bp.project_id AND p.name = &apos;${PROJECT}&apos;
AND b.id = bp.branch_id AND b.kind = &apos;special&apos;
ORDER BY b.name
&quot;&quot;&quot;

if (PROJECT) {
    result = [&apos;&apos;] + sql.rows(query).name
    sql.close()
    return result
} else {
    return [&quot;N/A&quot;]
}
</script>
                <fallbackScript>return [ &quot;error&quot; ]</fallbackScript>
              </script>
              <projectName>Request_Branch_Permission_Change</projectName>
              <parameters class="linked-hash-map"/>
              <referencedParameters>PROJECT</referencedParameters>
              <choiceType>PT_SINGLE_SELECT</choiceType>
              <filterable>true</filterable>
            </org.biouno.unochoice.CascadeChoiceParameter>
            <org.biouno.unochoice.DynamicReferenceParameter plugin="uno-choice@1.4">
              <name>CURRENT_PERMISSION</name>
              <description></description>
              <randomName>choice-parameter-3032966210883868</randomName>
              <visibleItemCount>1</visibleItemCount>
              <script class="org.biouno.unochoice.model.GroovyScript">
                <script>import groovy.sql.Sql
def String query = &quot;&quot;&quot;
SELECT m.name, m.fullname, ar.can_read, ar.can_write
FROM branches b, paths p, access_rights ar, members m, projects pro, branches_projects bp
WHERE b.path_id = p.id
AND ar.path_id = p.id
AND m.id = ar.member_id
AND bp.branch_id = b.id AND bp.project_id = pro.id
AND m.type = &apos;User&apos; AND b.name = &apos;${BRANCH}&apos; AND pro.name = &apos;${PROJECT}&apos;
ORDER BY m.name
&quot;&quot;&quot;

if (PROJECT &amp;&amp; BRANCH){    
    def access = &quot;&quot;
    def output = []
    sql.eachRow(query){ row -&gt;
	//row[0]: fullname
	//row[1]: username
	//row[2]: read
	//row[3]: write
	if (row[2] == true &amp;&amp; row[3] == true)
		access = &quot;R/W&quot;
	else if(row[2] == false &amp;&amp; row[3] == true)
		access = &quot;W&quot;
	else if(row[2] == true &amp;&amp; row[3] == false)
		access = &quot;R&quot;
	else if(row[2] == false &amp;&amp; row[3] == false)
		access = &quot;None&quot;
	else
		access = &quot;WRONG DATA&quot;
    output.push(row[1] + &quot; (&quot; + row[0] + &quot;)&quot; + &quot; - &quot; + access)
    }
    sql.close()
    return output
} else {
    return [&apos;N/A&apos;]
}
</script>
                <fallbackScript>return [&apos;error&apos;]</fallbackScript>
              </script>
              <projectName>Request_Branch_Permission_Change</projectName>
              <parameters class="linked-hash-map"/>
              <referencedParameters>PROJECT,BRANCH</referencedParameters>
              <choiceType>ET_UNORDERED_LIST</choiceType>
              <omitValueField>false</omitValueField>
            </org.biouno.unochoice.DynamicReferenceParameter>
            <com.cwctravel.hudson.plugins.extended__choice__parameter.ExtendedChoiceParameterDefinition plugin="extended-choice-parameter@0.76">
              <name>PERMISSION_CHANGE_JSON</name>
              <description>Update existing SVN permission</description>
              <quoteValue>false</quoteValue>
              <saveJSONParameterToFile>false</saveJSONParameterToFile>
              <visibleItemCount>5</visibleItemCount>
              <type>PT_JSON</type>
              <groovyScript>import org.boon.Boon;
import hudson.model.User
import groovy.sql.Sql

def String query = &quot;&quot;&quot;
SELECT name, fullname 
FROM members 
WHERE type = &apos;User&apos; 
ORDER BY name
&quot;&quot;&quot;

def JENKINS_USERLIST = sql.rows(query).collect{ row -&gt;
  &quot;${row.fullname} (${row.name})&quot;.toString()
}
sql.close()
JENKINS_USERLIST.sort()
// the json need explicit quotation &quot;&quot; for empty string in array
JENKINS_USERLIST = [&apos;&quot;&quot;&apos;] + JENKINS_USERLIST



def jsonEditorOptions = Boon.fromJson(/{
disable_edit_json: false,
disable_properties: false,
no_additional_properties: false,
disable_collapse: true,
disable_array_add: false,
disable_array_delete: false,
disable_array_reorder: true,
theme: &quot;bootstrap3&quot;,
iconlib:&quot;bootstrap3&quot;,

schema: {
&quot;title&quot;: &quot;Update SVN Permission:&quot;,
&quot;type&quot;: &quot;array&quot;,
&quot;format&quot;: &quot;table&quot;,
&quot;uniqueItems&quot;: true,
        &quot;items&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;title&quot;: &quot;User&quot;,
                &quot;properties&quot;: {
                        &quot;Username&quot;: {
                                &quot;type&quot;: &quot;string&quot;,
                                &quot;propertyOrder&quot;: 1,
                                &quot;enum&quot;: ${JENKINS_USERLIST}
                        },
                        &quot;Permission&quot;: {
                                &quot;type&quot;: &quot;string&quot;,
                                &quot;propertyOrder&quot;: 2,
                                &quot;enum&quot;: [
                                        &quot;&quot;,
                                        &quot;R&quot;,
                                        &quot;RW&quot;,
                                        &quot;DEL&quot;
                                ]
                        }
                }
        }
},
startval: [  {&quot;Username&quot;: &quot;&quot;, &quot;Permission&quot;:&quot;&quot; } ]
}/);

return jsonEditorOptions;</groovyScript>
              <bindings></bindings>
              <groovyClasspath></groovyClasspath>
              <multiSelectDelimiter>,</multiSelectDelimiter>
              <projectName>Request_Branch_Permission_Change</projectName>
            </com.cwctravel.hudson.plugins.extended__choice__parameter.ExtendedChoiceParameterDefinition>
          </parameterDefinitions>
        </outer-class>
      </parameterDefinitionNames>
    </hudson.model.ParametersAction>
    <com.sonyericsson.rebuild.RebuildAction plugin="rebuild@1.25"/>
  </actions>
  <queueId>1079390</queueId>
  <timestamp>1518234317935</timestamp>
  <startTime>1518234317936</startTime>
  <result>SUCCESS</result>
  <description>&lt;html&gt;
  &lt;head&gt;
    &lt;style type=&apos;text/css&apos;&gt;
            table {
            border-collapse: collapse;
        }
        td {
            font-size: 15px;
            padding: 5px;
        }
        &lt;/style&gt;
  &lt;/head&gt;
  &lt;body id=&apos;main&apos;&gt;
    &lt;h3 id=&apos;title&apos;&gt;Permission change information&lt;/h3&gt;
    &lt;table border=&apos;1&apos;&gt;
      &lt;tr&gt;
        &lt;td&gt;PROJECT&lt;/td&gt;
        &lt;td&gt;Test v6.00&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;BRANCH&lt;/td&gt;
        &lt;td&gt;br_6-0_devops-test01&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;CURRENT_PERMISSION&lt;/td&gt;
        &lt;td&gt;
          &lt;table border=&apos;1&apos;&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Andrew Adrian (aadrian)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;David Shieh (dshieh)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Kevin Yu (kevinyu)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Rick Liu (rickliu)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;RW&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/table&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;PERMISSION_CHANGE&lt;/td&gt;
        &lt;td&gt;
          &lt;table border=&apos;1&apos;&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Kevin Yu (kevinyu)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;RW&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Rick Liu (rickliu)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;R&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td width=&apos;300&apos;&gt;Andrew Adrian (aadrian)&lt;/td&gt;
              &lt;td width=&apos;60&apos;&gt;NONE&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/table&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
    &lt;br /&gt;
    &lt;h3&gt;
      &lt;a href=&apos;https://jenkins.corp.fortinet.com/job/Test/job/Request_Branch_Permission_Change/97/promotion&apos;&gt;Approval Status&lt;/a&gt;
    &lt;/h3&gt;
  &lt;/body&gt;
&lt;/html&gt;</description>
  <displayName>#97 Test v6.00 - br_6-0_devops-test01</displayName>
  <duration>287</duration>
  <charset>UTF-8</charset>
  <keepLog>false</keepLog>
  <builtOn>jenkins-slave09</builtOn>
  <workspace>/home/devops/jenkins_slave/workspace/Test/Request_Branch_Permission_Change</workspace>
  <hudsonVersion>2.46.2</hudsonVersion>
  <scm class="hudson.scm.NullChangeLogParser"/>
  <culprits class="com.google.common.collect.EmptyImmutableSortedSet"/>
</build>